---
title: "Sentiment Analysis Over Time"
author: "Rachel Hubley"
editor_options: 
  chunk_output_type: console
---

This is just another page that can be linked! You are not required to include more than just *index.qmd*, but you are welcome to make content on different pages, if desired. This may help with managing GitHub commits, as well. 

Each page can have it's own list of references based on what you cite. For example, did you know that good graphs "have a clear purpose, show the data clearly, and make the message obvious"? [@vandem2019].

```{r}
#| label: setup
#| include: false

# Improve digit display and NA display for kable tables
options(scipen = 1, knitr.kable.NA = "")

# Load necessary packages
library(tidyverse)
library(ggplot2)
library(plotly)

```


```{r}
#| label: fig-sentiment
#| fig-cap: "AFINN Sentiment Scores of Inaugural Speeches"


# Load data
load("raw-data/inaugural_speech_analysis.Rdata") 

# Plot bar chart
ggplot(inaug_words_sentiment, aes(x = date, y = sentiment_avg, fill = sentiment_avg)) +
  geom_col(show.legend = FALSE) +
  scale_fill_gradient2(low = "#d61106", mid = "#d6d6d6", high = "#05853c", midpoint = 0) + 
  labs(
    title = "AFINN Sentiment Scores of Inaugural Speeches",
    x = "Year",
    y = "Average Sentiment"
  ) +
  theme_minimal()

## OR plotly...

p <- ggplot(inaug_words_sentiment, aes(
  x = date, y = sentiment_avg,
  text = paste("President:", president,
               "<br>Year:", date,
               "<br>Average Sentiment:", round(sentiment_avg, 3)),
  fill = sentiment_avg)) +
  geom_col(show.legend = FALSE) +
  scale_fill_gradient2(low = "#d61106", mid = "#d6d6d6", high = "#05853c", midpoint = 0) + 
  labs(
    title = "AFINN Sentiment Scores of Inaugural Speeches",
    x = "Year",
    y = "Average Sentiment"
  ) +
  theme_minimal()

ggplotly(p, tooltip = "text")


## Plotting readability/Flesh-Kincaid over time plot with a bar chart

ggplot(inaug_speeches_master, aes(x = date, y = Flesch.Kincaid, fill = Flesch.Kincaid)) +
  geom_col(show.legend = FALSE) +
  scale_fill_gradient2(low = "#d61106", mid = "#d6d6d6", high = "#05853c", midpoint = 0) + 
  labs(
    title = "Flesh-Kincaid score of Inaugural Speeches",
    x = "Year",
    y = "Flesh-Kincaid score"
  ) +
  theme_minimal()

## Plotting mean sentence length over time plot with a bar chart

ggplot(inaug_speeches_master, aes(x = date, y = meanSentenceLength, fill = meanSentenceLength)) +
  geom_col(show.legend = FALSE) +
  scale_fill_gradient2(low = "#d61106", mid = "#d6d6d6", high = "#05853c", midpoint = 0) + 
  labs(
    title = "Mean Sentence Length of Inaugural Speeches",
    x = "Year",
    y = "Mean Sentence Length"
  ) +
  theme_minimal()



```


