---
title: "other-other-page"
format: html
---

```{r}
library(ggplot2)
library(tidyverse)
library(plotly)
```

## Plotting mean sentence length over time plot with a bar chart

```{r}
# ggplot(inaug_speeches_master, aes(x = date, y = meanSentenceLength, fill = meanSentenceLength)) +
#   geom_col(show.legend = FALSE) +
#   scale_fill_gradient2(low = "#d61106", mid = "#d6d6d6", high = "#05853c", midpoint = 0) + 
#   labs(
#     title = "Mean Sentence Length of Inaugural Speeches",
#     x = "Year",
#     y = "Mean Sentence Length"
#   ) +
#   theme_minimal()


ms <- ggplot(inaug_speeches_master, aes(
  x = date, y = meanSentenceLength,
  text = paste("President:", president,
               "<br>Year:", date,
               "<br>Mean Sentence Length:", round(meanSentenceLength, 3)),
  fill = meanSentenceLength)) +
  geom_col(show.legend = FALSE) +
  scale_fill_gradient2(low = "#d61106", mid = "#d6d6d6", high = "#05853c", midpoint = 0) + 
  labs(
    title = "Mean Sentence Length of Inaugural Speeches",
    x = "Year",
    y = "Mean Sentence Length"
  ) +
  theme_minimal()

ggplotly(ms, tooltip = "text")


## Plotting readability/Flesh-Kincaid over time plot with a bar chart

# ggplot(inaug_speeches_master, aes(x = date, y = Flesch.Kincaid, fill = Flesch.Kincaid)) +
#   geom_col(show.legend = FALSE) +
#   scale_fill_gradient2(low = "#d61106", mid = "#d6d6d6", high = "#05853c", midpoint = 0) + 
#   labs(
#     title = "Flesh-Kincaid score of Inaugural Speeches",
#     x = "Year",
#     y = "Flesh-Kincaid score"
#   ) +
#   theme_minimal()


fk <- ggplot(inaug_speeches_master, aes(
  x = date, y = Flesch.Kincaid,
  text = paste("President:", president,
               "<br>Year:", date,
               "<br>Flesch.Kincaid:", round(Flesch.Kincaid, 3)),
  fill = Flesch.Kincaid)) +
  geom_col(show.legend = FALSE) +
  scale_fill_gradient2(low = "#d61106", mid = "#d6d6d6", high = "#05853c", midpoint = 0) + 
  labs(
    title = "Flesch-Kincaid score of Inaugural Speeches",
    x = "Year",
    y = "Flesch-Kincaid score"
  ) +
  theme_minimal()

ggplotly(fk, tooltip = "text")



# President with the hardest inaugural speech (highest Flesch-Kincaid score)
 highpres<- inaug_speeches_master |>
   filter(Flesch.Kincaid == max(Flesch.Kincaid, na.rm = TRUE)) |>
   select(president, date, Flesch.Kincaid)
 highpres
 
# President with the easiest inaugural speech (lowest Flesch-Kincaid score)
 lowpres <- inaug_speeches_master |>
   filter(Flesch.Kincaid == min(Flesch.Kincaid, na.rm = TRUE)) |>
   select(president, date, Flesch.Kincaid)
 lowpres
 
 pres_inaug <- full_join(highpres, lowpres)
 
 # table displaying the presidents with the highest and lowest Flesch-Kincaid score 
  pres_inaug |>
  kable(booktabs = TRUE, 
        digits = 2,
        col.names = c("", 
                      "", 
                      "" )) |>
  kable_styling()

```



